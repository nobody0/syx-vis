<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Interactive production chain visualizer for Songs of Syx. Explore building recipes, resource flows, population needs, and production balancing.">
  <meta property="og:title" content="Production Chain Atlas – Songs of Syx">
  <meta property="og:description" content="Interactive production chain visualizer for Songs of Syx">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://nobody0.github.io/syx-vis/">
  <meta name="theme-color" content="#0c1014">
  <title>Production Chain Atlas – Songs of Syx</title>
  <link rel="icon" href="favicon.svg" type="image/svg+xml">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
  <link rel="stylesheet" href="display/style.css">

  <!-- D3.js v7.9.0 (UMD, attaches to window.d3) -->
  <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"
          integrity="sha384-CjloA8y00+1SDAUkjs099PVfnY2KmDC2BZnws9kh8D/lX1s46w6EPhpXdqMfjK6i"
          crossorigin="anonymous"></script>

  <!-- PixiJS v8.6.6 import map (WebGL canvas renderer for graph tab) -->
  <script type="importmap">
  {
    "imports": {
      "pixi.js": "https://cdn.jsdelivr.net/npm/pixi.js@8.6.6/dist/pixi.min.mjs"
    }
  }
  </script>
</head>
<body>
  <div id="header-bar" class="ui-panel">
    <div id="header-title">
      <h1>Production Chain Atlas</h1>
      <span class="subtitle">A community tool for Songs of Syx</span>
    </div>
    <div class="header-sep"></div>
    <div id="tab-bar">
      <button class="tab active" data-tab="graph" title="Alt+1"><span class="tab-icon">&#9671;</span> Graph</button>
      <button class="tab" data-tab="population" title="Alt+2"><span class="tab-icon">&#9673;</span> Population</button>
      <button class="tab" data-tab="upkeep" title="Alt+3"><span class="tab-icon">&#9651;</span> Upkeep</button>
      <button class="tab" data-tab="balancing" title="Alt+4"><span class="tab-icon">&#9655;</span> Balancing</button>
    </div>
    <button id="help-btn" title="Keyboard shortcuts (?)" aria-label="Keyboard shortcuts">?</button>
  </div>

  <div id="view-graph" class="view active">
    <div id="breadcrumb-bar"></div>

    <div id="filter-panel" class="ui-panel"></div>
    <div id="graph-container"></div>
    <div id="detail-panel" class="ui-panel"></div>

    <div id="legend" class="ui-panel"></div>

    <div id="stats-bar" class="ui-panel"></div>
  </div>

  <div id="view-population" class="view"></div>
  <div id="view-upkeep" class="view"></div>
  <div id="view-balancing" class="view"></div>

  <!--
    ES Modules require an HTTP server — file:// will block imports due to CORS.
    Serve with:  npx serve .
    Then open:   http://localhost:3000
  -->
  <script type="module">
    try {
      const { render } = await import("./display/render.js");
      const { initTabs } = await import("./display/tabs.js");
      render();
      initTabs();
    } catch (err) {
      document.body.style.display = "flex";
      document.body.style.justifyContent = "center";
      document.body.style.paddingTop = "20vh";
      document.body.innerHTML = `<div style="color:#d8d2c4;font-family:system-ui;text-align:center">
        <h2 style="font-family:Georgia,serif;font-style:italic">Failed to load</h2>
        <p style="color:#a09882">${err.message || err}</p>
        <p style="color:#706858;font-size:13px">Check the browser console for details.</p>
      </div>`;
    }
  </script>
</body>
</html>
